#################################################################################################################
###################### Article: The Role of Direct Capital Cash Transfers Towards Poverty #######################
########################### and Extreme Poverty Alleviation - An Omega Risk Process #############################
########################### Authors: Flores-Contró, José M. and Arnold, Séverine ################################
#################################################################################################################

################################################################################################################
############################################ LOADING PACKAGES ##################################################
################################################################################################################

# We load the packages.

library(tikzDevice)
options(tikzMetricPackages = c("\\usepackage[utf8]{inputenc}", "\\usepackage[T1]{fontenc}", "\\usetikzlibrary{calc}", "\\usepackage{amssymb}"))
library(ggsci)

################################################################################################################
########################################## 1st SET OF FUNCTIONS ################################################
################################################################################################################

# The function below produces Figure 2 (a).

# Function No. 1

PlotTrappingProbability1 <- function(cc = c(0.1, 1, 10, 100), PovertyLine = 1, B = 2, file = "/Users/josemiguelflorescontro/Desktop"){
  # cc indicates the capital cash transfer rate. Note that, this is a vector that contains the values for which one wants to perform the analysis. Moreover, these values should match the ones in the Mathematica notebook: TrappingProbability.nb
  # PovertyLine indicates the value of the critical capital x* (or poverty line). This value should match the one in the Mathematica notebook: TrappingProbability.nb
  # B indicates the value of the capital barrier level. This value should match the one in the Mathematica notebook: TrappingProbability.nb
  # file is the location where the .tex file that will be used to generate the plot is going to be saved.
  
  setwd(file)
  MyColors <- pal_jco()(length(cc) + 1) 
  MyLines <-seq(from = 1, to = length(cc) + 1, by = 1)
  TrappingProbability <- vector()
  my.expressions <- vector()
  # The values below were generated using Mathematica. In particular, they are outputs of the notebook: TrappingProbability.nb
  x <- c(1., 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11, 
         1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18, 1.19, 1.2, 1.21, 1.22, 
         1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33, 
         1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4, 1.41, 1.42, 1.43, 1.44, 
         1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55, 
         1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.63, 1.64, 1.65, 1.66, 
         1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77, 
         1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.88, 
         1.89, 1.9, 1.91, 1.92, 1.93, 1.94, 1.95, 1.96, 1.97, 1.98, 1.99, 2., 
         2.01, 2.02, 2.03, 2.04, 2.05, 2.06, 2.07, 2.08, 2.09, 2.1, 2.11, 
         2.12, 2.13, 2.14, 2.15, 2.16, 2.17, 2.18, 2.19, 2.2, 2.21, 2.22, 
         2.23, 2.24, 2.25, 2.26, 2.27, 2.28, 2.29, 2.3, 2.31, 2.32, 2.33, 
         2.34, 2.35, 2.36, 2.37, 2.38, 2.39, 2.4, 2.41, 2.42, 2.43, 2.44, 
         2.45, 2.46, 2.47, 2.48, 2.49, 2.5, 2.51, 2.52, 2.53, 2.54, 2.55, 
         2.56, 2.57, 2.58, 2.59, 2.6, 2.61, 2.62, 2.63, 2.64, 2.65, 2.66, 
         2.67, 2.68, 2.69, 2.7, 2.71, 2.72, 2.73, 2.74, 2.75, 2.76, 2.77, 
         2.78, 2.79, 2.8, 2.81, 2.82, 2.83, 2.84, 2.85, 2.86, 2.87, 2.88, 
         2.89, 2.9, 2.91, 2.92, 2.93, 2.94, 2.95, 2.96, 2.97, 2.98, 2.99, 3., 
         3.01, 3.02, 3.03, 3.04, 3.05, 3.06, 3.07, 3.08, 3.09, 3.1, 3.11, 
         3.12, 3.13, 3.14, 3.15, 3.16, 3.17, 3.18, 3.19, 3.2, 3.21, 3.22, 
         3.23, 3.24, 3.25, 3.26, 3.27, 3.28, 3.29, 3.3, 3.31, 3.32, 3.33, 
         3.34, 3.35, 3.36, 3.37, 3.38, 3.39, 3.4, 3.41, 3.42, 3.43, 3.44, 
         3.45, 3.46, 3.47, 3.48, 3.49, 3.5, 3.51, 3.52, 3.53, 3.54, 3.55, 
         3.56, 3.57, 3.58, 3.59, 3.6, 3.61, 3.62, 3.63, 3.64, 3.65, 3.66, 
         3.67, 3.68, 3.69, 3.7, 3.71, 3.72, 3.73, 3.74, 3.75, 3.76, 3.77, 
         3.78, 3.79, 3.8, 3.81, 3.82, 3.83, 3.84, 3.85, 3.86, 3.87, 3.88, 
         3.89, 3.9, 3.91, 3.92, 3.93, 3.94, 3.95, 3.96, 3.97, 3.98, 3.99, 4., 
         4.01, 4.02, 4.03, 4.04, 4.05, 4.06, 4.07, 4.08, 4.09, 4.1, 4.11, 
         4.12, 4.13, 4.14, 4.15, 4.16, 4.17, 4.18, 4.19, 4.2, 4.21, 4.22, 
         4.23, 4.24, 4.25, 4.26, 4.27, 4.28, 4.29, 4.3, 4.31, 4.32, 4.33, 
         4.34, 4.35, 4.36, 4.37, 4.38, 4.39, 4.4, 4.41, 4.42, 4.43, 4.44, 
         4.45, 4.46, 4.47, 4.48, 4.49, 4.5, 4.51, 4.52, 4.53, 4.54, 4.55, 
         4.56, 4.57, 4.58, 4.59, 4.6, 4.61, 4.62, 4.63, 4.64, 4.65, 4.66, 
         4.67, 4.68, 4.69, 4.7, 4.71, 4.72, 4.73, 4.74, 4.75, 4.76, 4.77, 
         4.78, 4.79, 4.8, 4.81, 4.82, 4.83, 4.84, 4.85, 4.86, 4.87, 4.88, 
         4.89, 4.9, 4.91, 4.92, 4.93, 4.94, 4.95, 4.96, 4.97, 4.98, 4.99, 5.)
  for (i in 1:length(cc)){
    my.expressions <-c(my.expressions, paste0("$c_{\\scaleto{T}{4pt}}$", " = ", cc[i]) )
    if (i==1){
      TrappingProbability <- c(0.980541, 0.978635, 0.976799, 0.975025, 0.973308, 0.971641, 0.970021, 
                               0.968442, 0.966903, 0.9654, 0.96393, 0.962493, 0.961085, 0.959705, 
                               0.958352, 0.957024, 0.95572, 0.95444, 0.953181, 0.951942, 0.950724, 
                               0.949525, 0.948345, 0.947182, 0.946037, 0.944908, 0.943795, 0.942697, 
                               0.941615, 0.940546, 0.939492, 0.938451, 0.937423, 0.936408, 0.935406, 
                               0.934415, 0.933437, 0.932469, 0.931513, 0.930568, 0.929633, 0.928708, 
                               0.927793, 0.926889, 0.925993, 0.925108, 0.924231, 0.923363, 0.922504, 
                               0.921653, 0.920811, 0.919977, 0.919151, 0.918333, 0.917522, 0.916719, 
                               0.915923, 0.915135, 0.914354, 0.913579, 0.912812, 0.912051, 0.911297, 
                               0.910549, 0.909807, 0.909072, 0.908343, 0.90762, 0.906902, 0.906191, 
                               0.905485, 0.904785, 0.90409, 0.903401, 0.902717, 0.902039, 0.901365, 
                               0.900697, 0.900034, 0.899375, 0.898722, 0.898073, 0.897429, 0.896789, 
                               0.896155, 0.895524, 0.894898, 0.894277, 0.89366, 0.893047, 0.892438, 
                               0.891833, 0.891233, 0.890636, 0.890044, 0.889455, 0.88887, 0.888289, 
                               0.887712, 0.887139, 0.886569, 0.886003, 0.885441, 0.884882, 0.884328, 
                               0.883778, 0.883231, 0.882688, 0.882148, 0.881612, 0.88108, 0.880551, 
                               0.880026, 0.879504, 0.878985, 0.87847, 0.877957, 0.877449, 0.876943, 
                               0.876441, 0.875941, 0.875445, 0.874952, 0.874461, 0.873974, 0.87349, 
                               0.873008, 0.87253, 0.872054, 0.871581, 0.871111, 0.870644, 0.870179, 
                               0.869717, 0.869257, 0.8688, 0.868346, 0.867894, 0.867445, 0.866999, 
                               0.866554, 0.866113, 0.865673, 0.865236, 0.864802, 0.86437, 0.86394, 
                               0.863512, 0.863087, 0.862664, 0.862243, 0.861824, 0.861407, 0.860993, 
                               0.860581, 0.860171, 0.859763, 0.859357, 0.858953, 0.858551, 0.858151, 
                               0.857753, 0.857357, 0.856963, 0.856571, 0.856181, 0.855793, 0.855406, 
                               0.855022, 0.854639, 0.854258, 0.853879, 0.853502, 0.853127, 0.852753, 
                               0.852381, 0.852011, 0.851642, 0.851276, 0.85091, 0.850547, 0.850185, 
                               0.849825, 0.849466, 0.849109, 0.848754, 0.8484, 0.848048, 0.847697, 
                               0.847348, 0.847001, 0.846655, 0.84631, 0.845967, 0.845626, 0.845285, 
                               0.844947, 0.844609, 0.844274, 0.843939, 0.843606, 0.843275, 0.842944, 
                               0.842616, 0.842288, 0.841962, 0.841637, 0.841314, 0.840992, 0.840671, 
                               0.840351, 0.840033, 0.839716, 0.8394, 0.839086, 0.838773, 0.838461, 
                               0.83815, 0.83784, 0.837532, 0.837225, 0.836919, 0.836614, 0.836311, 
                               0.836008, 0.835707, 0.835407, 0.835108, 0.83481, 0.834514, 0.834218, 
                               0.833923, 0.83363, 0.833338, 0.833047, 0.832756, 0.832467, 0.832179, 
                               0.831893, 0.831607, 0.831322, 0.831038, 0.830755, 0.830473, 0.830193, 
                               0.829913, 0.829634, 0.829356, 0.829079, 0.828804, 0.828529, 0.828255, 
                               0.827982, 0.82771, 0.827439, 0.827169, 0.8269, 0.826631, 0.826364, 
                               0.826098, 0.825832, 0.825567, 0.825304, 0.825041, 0.824779, 0.824518, 
                               0.824258, 0.823998, 0.82374, 0.823482, 0.823225, 0.822969, 0.822714, 
                               0.82246, 0.822207, 0.821954, 0.821702, 0.821451, 0.821201, 0.820952, 
                               0.820703, 0.820455, 0.820209, 0.819962, 0.819717, 0.819472, 0.819228, 
                               0.818985, 0.818743, 0.818501, 0.81826, 0.81802, 0.817781, 0.817542, 
                               0.817305, 0.817067, 0.816831, 0.816595, 0.81636, 0.816126, 0.815892, 
                               0.81566, 0.815427, 0.815196, 0.814965, 0.814735, 0.814506, 0.814277, 
                               0.814049, 0.813821, 0.813595, 0.813369, 0.813143, 0.812919, 0.812695, 
                               0.812471, 0.812248, 0.812026, 0.811805, 0.811584, 0.811364, 0.811144, 
                               0.810925, 0.810707, 0.810489, 0.810272, 0.810055, 0.809839, 0.809624, 
                               0.809409, 0.809195, 0.808982, 0.808769, 0.808557, 0.808345, 0.808134, 
                               0.807923, 0.807713, 0.807504, 0.807295, 0.807087, 0.806879, 0.806672, 
                               0.806465, 0.806259, 0.806054, 0.805849, 0.805645, 0.805441, 0.805237, 
                               0.805035, 0.804832, 0.804631, 0.80443, 0.804229, 0.804029, 0.803829, 
                               0.80363, 0.803432, 0.803234, 0.803036, 0.802839, 0.802643, 0.802447, 
                               0.802251, 0.802056, 0.801862, 0.801668, 0.801474, 0.801281, 0.801089, 
                               0.800897, 0.800705, 0.800514, 0.800324, 0.800134, 0.799944, 0.799755, 
                               0.799566, 0.799378, 0.79919, 0.799003, 0.798816, 0.79863, 0.798444, 
                               0.798258, 0.798073, 0.797889, 0.797705, 0.797521, 0.797338, 0.797155, 
                               0.796973, 0.796791, 0.796609, 0.796428, 0.796248, 0.796067, 0.795888, 
                               0.795708, 0.79553)
      # This is the name of the .tex file that will be saved in the location specified in the function.
      tikz('PlotTrappingProbability1.tex', standAlone = TRUE, width = 4, height = 4, packages = c("\\usepackage{tikz}", "\\usepackage[active,tightpage,psfixbb]{preview}", "\\PreviewEnvironment{pgfpicture}", "\\setlength\\PreviewBorder{0pt}", "\\usepackage{amssymb}", "\\usepackage{scalerel}"))
      par(mgp = c(2.5, 1, 0), mar = c(3.5, 3.5, 1, 1) + 0.1)
      plot(x, TrappingProbability, type = "l", lwd = 2, lty = MyLines[2], col = MyColors[2], xaxs = "i", yaxs = "i", xlab = "Initial Capital", ylab = "$\\psi^{\\scaleto{{\\fontfamily{qcr}\\selectfont P}}{2.5pt}}(x)$", ylim = c(0, 1), xlim = c(min(x), max(x)), cex.lab = 1, cex.axis = 1, xaxt = "n")
      abline(v = PovertyLine, lty = 2, lwd = 0.5, col = "red")
      abline(v = B, lty = 2, lwd = 0.5, col = "#009900")
      axis(1,at = c(1, 2, 3, 4, 5), labels = FALSE)
      mtext(c("$x^{*} = 1$", "$B = 2$", "3", "4", "5"), side = 1, line = 1, at = c(1, 2, 3, 4, 5), col = c("red", "#009900", rep("black", 3)))
    }else if (i == 2){
        TrappingProbability <- c(0.938262, 0.937646, 0.937031, 0.936417, 0.935804, 0.935193, 0.934584, 
                                 0.933975, 0.933368, 0.932762, 0.932157, 0.931553, 0.930951, 0.930349, 
                                 0.929749, 0.929149, 0.928551, 0.927954, 0.927357, 0.926762, 0.926167, 
                                 0.925574, 0.924981, 0.924389, 0.923798, 0.923208, 0.922619, 0.92203, 
                                 0.921442, 0.920855, 0.920269, 0.919683, 0.919098, 0.918514, 0.91793, 
                                 0.917347, 0.916764, 0.916183, 0.915601, 0.915021, 0.914441, 0.913861, 
                                 0.913282, 0.912704, 0.912126, 0.911549, 0.910972, 0.910395, 0.909819, 
                                 0.909244, 0.908669, 0.908094, 0.90752, 0.906946, 0.906372, 0.905799, 
                                 0.905226, 0.904654, 0.904082, 0.90351, 0.902939, 0.902368, 0.901797, 
                                 0.901227, 0.900657, 0.900087, 0.899518, 0.898949, 0.89838, 0.897811, 
                                 0.897242, 0.896674, 0.896106, 0.895539, 0.894971, 0.894404, 0.893837, 
                                 0.89327, 0.892703, 0.892136, 0.89157, 0.891004, 0.890438, 0.889872, 
                                 0.889306, 0.888741, 0.888175, 0.88761, 0.887045, 0.88648, 0.885915, 
                                 0.88535, 0.884785, 0.884221, 0.883656, 0.883092, 0.882527, 0.881963, 
                                 0.881399, 0.880835, 0.880271, 0.879709, 0.879151, 0.878597, 0.878046, 
                                 0.877499, 0.876957, 0.876417, 0.875882, 0.875349, 0.874821, 0.874296, 
                                 0.873774, 0.873256, 0.872741, 0.872229, 0.871721, 0.871216, 0.870714, 
                                 0.870215, 0.869719, 0.869226, 0.868736, 0.86825, 0.867766, 0.867285, 
                                 0.866807, 0.866332, 0.865859, 0.86539, 0.864923, 0.864459, 0.863997, 
                                 0.863538, 0.863082, 0.862629, 0.862178, 0.861729, 0.861283, 0.86084, 
                                 0.860399, 0.85996, 0.859524, 0.85909, 0.858659, 0.858229, 0.857802, 
                                 0.857378, 0.856956, 0.856535, 0.856118, 0.855702, 0.855288, 0.854877, 
                                 0.854467, 0.85406, 0.853655, 0.853252, 0.852851, 0.852452, 0.852055, 
                                 0.85166, 0.851267, 0.850876, 0.850486, 0.850099, 0.849713, 0.84933, 
                                 0.848948, 0.848568, 0.84819, 0.847814, 0.847439, 0.847066, 0.846695, 
                                 0.846326, 0.845958, 0.845593, 0.845228, 0.844866, 0.844505, 0.844146, 
                                 0.843788, 0.843432, 0.843078, 0.842725, 0.842374, 0.842024, 0.841676, 
                                 0.841329, 0.840984, 0.84064, 0.840298, 0.839958, 0.839618, 0.839281, 
                                 0.838944, 0.83861, 0.838276, 0.837944, 0.837614, 0.837284, 0.836956, 
                                 0.83663, 0.836305, 0.835981, 0.835658, 0.835337, 0.835017, 0.834699, 
                                 0.834382, 0.834066, 0.833751, 0.833437, 0.833125, 0.832814, 0.832504, 
                                 0.832196, 0.831889, 0.831582, 0.831278, 0.830974, 0.830671, 0.83037, 
                                 0.83007, 0.82977, 0.829473, 0.829176, 0.82888, 0.828585, 0.828292, 
                                 0.828, 0.827708, 0.827418, 0.827129, 0.826841, 0.826554, 0.826268, 
                                 0.825983, 0.825699, 0.825416, 0.825134, 0.824854, 0.824574, 0.824295, 
                                 0.824017, 0.823741, 0.823465, 0.82319, 0.822916, 0.822643, 0.822371, 
                                 0.8221, 0.82183, 0.821561, 0.821293, 0.821026, 0.820759, 0.820494, 
                                 0.820229, 0.819966, 0.819703, 0.819441, 0.81918, 0.81892, 0.818661, 
                                 0.818402, 0.818145, 0.817888, 0.817632, 0.817377, 0.817123, 0.81687, 
                                 0.816618, 0.816366, 0.816115, 0.815865, 0.815616, 0.815368, 0.81512, 
                                 0.814873, 0.814627, 0.814382, 0.814138, 0.813894, 0.813651, 0.813409, 
                                 0.813167, 0.812927, 0.812687, 0.812448, 0.812209, 0.811972, 0.811735, 
                                 0.811499, 0.811263, 0.811028, 0.810794, 0.810561, 0.810328, 0.810097, 
                                 0.809865, 0.809635, 0.809405, 0.809176, 0.808947, 0.80872, 0.808493, 
                                 0.808266, 0.80804, 0.807815, 0.807591, 0.807367, 0.807144, 0.806921, 
                                 0.8067, 0.806478, 0.806258, 0.806038, 0.805819, 0.8056, 0.805382, 
                                 0.805164, 0.804948, 0.804731, 0.804516, 0.804301, 0.804087, 0.803873, 
                                 0.80366, 0.803447, 0.803235, 0.803024, 0.802813, 0.802603, 0.802393, 
                                 0.802184, 0.801976, 0.801768, 0.80156, 0.801353, 0.801147, 0.800942, 
                                 0.800736, 0.800532, 0.800328, 0.800124, 0.799921, 0.799719, 0.799517, 
                                 0.799316, 0.799115, 0.798915, 0.798715, 0.798516, 0.798317, 0.798119, 
                                 0.797922, 0.797724, 0.797528, 0.797332, 0.797136, 0.796941, 0.796746, 
                                 0.796552, 0.796359, 0.796166, 0.795973, 0.795781, 0.795589, 0.795398, 
                                 0.795207, 0.795017, 0.794828, 0.794638, 0.79445, 0.794261, 0.794074, 
                                 0.793886, 0.793699, 0.793513, 0.793327, 0.793141, 0.792956, 0.792772, 
                                 0.792588, 0.792404, 0.792221, 0.792038, 0.791856, 0.791674, 0.791492, 
                                 0.791311, 0.791131, 0.79095, 0.790771, 0.790591, 0.790412, 0.790234, 
                                 0.790056, 0.789878)
      lines(x, TrappingProbability, type = "l", lty = MyLines[i + 1], lwd = 2, col = MyColors[i + 1])
    } else if (i == 3){
      TrappingProbability <- c(0.888634, 0.888522, 0.888411, 0.888299, 0.888187, 0.888074, 0.887962, 
                               0.887849, 0.887736, 0.887622, 0.887508, 0.887394, 0.887279, 0.887164, 
                               0.887049, 0.886933, 0.886817, 0.8867, 0.886583, 0.886465, 0.886346, 
                               0.886227, 0.886108, 0.885987, 0.885867, 0.885745, 0.885623, 0.8855, 
                               0.885376, 0.885251, 0.885126, 0.885, 0.884873, 0.884745, 0.884616, 
                               0.884486, 0.884355, 0.884223, 0.88409, 0.883956, 0.883821, 0.883684, 
                               0.883547, 0.883408, 0.883267, 0.883126, 0.882982, 0.882838, 0.882692, 
                               0.882544, 0.882394, 0.882243, 0.88209, 0.881936, 0.881779, 0.88162, 
                               0.88146, 0.881297, 0.881132, 0.880964, 0.880795, 0.880622, 0.880447, 
                               0.88027, 0.880089, 0.879906, 0.87972, 0.87953, 0.879337, 0.87914, 
                               0.87894, 0.878736, 0.878527, 0.878315, 0.878098, 0.877876, 0.877649, 
                               0.877417, 0.87718, 0.876937, 0.876687, 0.876431, 0.876168, 0.875898, 
                               0.87562, 0.875333, 0.875038, 0.874733, 0.874417, 0.874091, 0.873752, 
                               0.873401, 0.873036, 0.872655, 0.872258, 0.871843, 0.871407, 0.87095,
                               0.870468, 0.869958, 0.869418, 0.868863, 0.868311, 0.867764, 0.86722, 
                               0.86668, 0.866144, 0.865612, 0.865082, 0.864557, 0.864035, 0.863516, 
                               0.863001, 0.862489, 0.86198, 0.861475, 0.860973, 0.860474, 0.859978, 
                               0.859485, 0.858996, 0.858509, 0.858025, 0.857545, 0.857067, 0.856592, 
                               0.85612, 0.85565, 0.855184, 0.85472, 0.854259, 0.8538, 0.853345, 
                               0.852892, 0.852441, 0.851993, 0.851548, 0.851105, 0.850664, 0.850226, 
                               0.84979, 0.849357, 0.848926, 0.848498, 0.848072, 0.847648, 0.847226, 
                               0.846807, 0.84639, 0.845975, 0.845562, 0.845151, 0.844743, 0.844337, 
                               0.843932, 0.84353, 0.84313, 0.842732, 0.842336, 0.841942, 0.84155, 
                               0.841159, 0.840771, 0.840385, 0.84, 0.839618, 0.839237, 0.838858, 
                               0.838481, 0.838106, 0.837732, 0.837361, 0.836991, 0.836623, 0.836256, 
                               0.835891, 0.835528, 0.835167, 0.834807, 0.834449, 0.834093, 0.833738, 
                               0.833385, 0.833033, 0.832683, 0.832334, 0.831988, 0.831642, 0.831298, 
                               0.830956, 0.830615, 0.830276, 0.829938, 0.829601, 0.829266, 0.828933, 
                               0.828601, 0.82827, 0.827941, 0.827613, 0.827286, 0.826961, 0.826637, 
                               0.826315, 0.825994, 0.825674, 0.825355, 0.825038, 0.824722, 0.824407, 
                               0.824094, 0.823782, 0.823471, 0.823162, 0.822853, 0.822546, 0.82224, 
                               0.821935, 0.821632, 0.82133, 0.821028, 0.820728, 0.82043, 0.820132, 
                               0.819835, 0.81954, 0.819246, 0.818952, 0.81866, 0.818369, 0.81808, 
                               0.817791, 0.817503, 0.817216, 0.816931, 0.816646, 0.816363, 0.81608, 
                               0.815799, 0.815519, 0.815239, 0.814961, 0.814684, 0.814407, 0.814132, 
                               0.813858, 0.813584, 0.813312, 0.81304, 0.81277, 0.8125, 0.812232, 
                               0.811964, 0.811697, 0.811432, 0.811167, 0.810903, 0.81064, 0.810377, 
                               0.810116, 0.809856, 0.809596, 0.809338, 0.80908, 0.808823, 0.808567, 
                               0.808312, 0.808058, 0.807804, 0.807551, 0.8073, 0.807049, 0.806799, 
                               0.806549, 0.806301, 0.806053, 0.805806, 0.80556, 0.805315, 0.80507, 
                               0.804826, 0.804583, 0.804341, 0.8041, 0.803859, 0.803619, 0.80338, 
                               0.803142, 0.802904, 0.802667, 0.802431, 0.802195, 0.801961, 0.801727, 
                               0.801493, 0.801261, 0.801029, 0.800798, 0.800567, 0.800338, 0.800109, 
                               0.79988, 0.799652, 0.799425, 0.799199, 0.798974, 0.798749, 0.798524, 
                               0.798301, 0.798078, 0.797855, 0.797634, 0.797413, 0.797192, 0.796972, 
                               0.796753, 0.796535, 0.796317, 0.7961, 0.795883, 0.795667, 0.795452, 
                               0.795237, 0.795023, 0.79481, 0.794597, 0.794384, 0.794173, 0.793962, 
                               0.793751, 0.793541, 0.793332, 0.793123, 0.792915, 0.792707, 0.7925, 
                               0.792294, 0.792088, 0.791882, 0.791677, 0.791473, 0.79127, 0.791066, 
                               0.790864, 0.790662, 0.79046, 0.790259, 0.790059, 0.789859, 0.78966, 
                               0.789461, 0.789262, 0.789065, 0.788867, 0.788671, 0.788474, 0.788279, 
                               0.788084, 0.787889, 0.787695, 0.787501, 0.787308, 0.787115, 0.786923, 
                               0.786731, 0.78654, 0.786349, 0.786159, 0.785969, 0.78578, 0.785591, 
                               0.785403, 0.785215, 0.785028, 0.784841, 0.784655, 0.784469, 0.784283, 
                               0.784098, 0.783913, 0.783729, 0.783546, 0.783362, 0.78318, 0.782997, 
                               0.782816, 0.782634, 0.782453, 0.782273, 0.782092, 0.781913, 0.781734, 
                               0.781555, 0.781376, 0.781198, 0.781021, 0.780844, 0.780667, 0.780491, 
                               0.780315, 0.78014)
      lines(x, TrappingProbability, type = "l", lty = MyLines[i + 1], lwd = 2, col = MyColors[i + 1])
    } else{
      TrappingProbability <- c(0.867147, 0.867133, 0.86712, 0.867107, 0.867093, 0.86708, 0.867066, 
                               0.867053, 0.867039, 0.867026, 0.867012, 0.866998, 0.866985, 0.866971, 
                               0.866957, 0.866943, 0.866929, 0.866915, 0.866901, 0.866887, 0.866872, 
                               0.866858, 0.866843, 0.866829, 0.866814, 0.866799, 0.866785, 0.86677, 
                               0.866755, 0.866739, 0.866724, 0.866709, 0.866693, 0.866678, 0.866662, 
                               0.866646, 0.86663, 0.866613, 0.866597, 0.86658, 0.866564, 0.866547, 
                               0.86653, 0.866512, 0.866495, 0.866477, 0.866459, 0.866441, 0.866423, 
                               0.866404, 0.866385, 0.866366, 0.866346, 0.866326, 0.866306, 0.866286, 
                               0.866265, 0.866244, 0.866223, 0.866201, 0.866178, 0.866156, 0.866132, 
                               0.866109, 0.866084, 0.86606, 0.866034, 0.866008, 0.865982, 0.865955, 
                               0.865927, 0.865898, 0.865868, 0.865838, 0.865806, 0.865774, 0.86574, 
                               0.865706, 0.86567, 0.865632, 0.865593, 0.865552, 0.86551, 0.865465, 
                               0.865418, 0.865368, 0.865316, 0.86526, 0.8652, 0.865136, 0.865067, 
                               0.864992, 0.86491, 0.864818, 0.864716, 0.864599, 0.864462, 0.864298, 
                               0.864093, 0.863818, 0.863397, 0.862846, 0.862298, 0.861755, 0.861215, 
                               0.860679, 0.860146, 0.859617, 0.859092, 0.85857, 0.858051, 0.857536, 
                               0.857025, 0.856516, 0.856011, 0.855509, 0.855011, 0.854515, 0.854023, 
                               0.853533, 0.853047, 0.852564, 0.852083, 0.851606, 0.851132, 0.85066, 
                               0.850191, 0.849725, 0.849262, 0.848801, 0.848343, 0.847888, 0.847435, 
                               0.846985, 0.846538, 0.846093, 0.845651, 0.845211, 0.844773, 0.844338, 
                               0.843906, 0.843476, 0.843048, 0.842622, 0.842199, 0.841778, 0.841359, 
                               0.840943, 0.840529, 0.840116, 0.839707, 0.839299, 0.838893, 0.83849, 
                               0.838088, 0.837689, 0.837291, 0.836896, 0.836503, 0.836111, 0.835722, 
                               0.835334, 0.834949, 0.834565, 0.834183, 0.833803, 0.833425, 0.833049, 
                               0.832675, 0.832302, 0.831931, 0.831562, 0.831195, 0.830829, 0.830465, 
                               0.830103, 0.829742, 0.829383, 0.829026, 0.828671, 0.828317, 0.827964, 
                               0.827613, 0.827264, 0.826917, 0.826571, 0.826226, 0.825883, 0.825542, 
                               0.825202, 0.824863, 0.824526, 0.824191, 0.823856, 0.823524, 0.823193, 
                               0.822863, 0.822534, 0.822207, 0.821882, 0.821557, 0.821234, 0.820913, 
                               0.820593, 0.820274, 0.819956, 0.81964, 0.819325, 0.819011, 0.818699, 
                               0.818387, 0.818077, 0.817769, 0.817461, 0.817155, 0.81685, 0.816546, 
                               0.816244, 0.815942, 0.815642, 0.815343, 0.815045, 0.814748, 0.814452, 
                               0.814158, 0.813865, 0.813572, 0.813281, 0.812991, 0.812702, 0.812414, 
                               0.812128, 0.811842, 0.811557, 0.811274, 0.810991, 0.81071, 0.810429, 
                               0.81015, 0.809871, 0.809594, 0.809317, 0.809042, 0.808768, 0.808494, 
                               0.808222, 0.80795, 0.80768, 0.80741, 0.807142, 0.806874, 0.806607, 
                               0.806341, 0.806076, 0.805812, 0.805549, 0.805287, 0.805026, 0.804766, 
                               0.804506, 0.804248, 0.80399, 0.803733, 0.803477, 0.803222, 0.802968, 
                               0.802714, 0.802462, 0.80221, 0.801959, 0.801709, 0.80146, 0.801211, 
                               0.800964, 0.800717, 0.800471, 0.800226, 0.799981, 0.799738, 0.799495, 
                               0.799253, 0.799012, 0.798771, 0.798531, 0.798292, 0.798054, 0.797817, 
                               0.79758, 0.797344, 0.797109, 0.796874, 0.79664, 0.796407, 0.796175, 
                               0.795943, 0.795712, 0.795482, 0.795252, 0.795023, 0.794795, 0.794568, 
                               0.794341, 0.794115, 0.79389, 0.793665, 0.793441, 0.793217, 0.792995, 
                               0.792772, 0.792551, 0.79233, 0.79211, 0.791891, 0.791672, 0.791454, 
                               0.791236, 0.791019, 0.790803, 0.790587, 0.790372, 0.790157, 0.789944, 
                               0.78973, 0.789518, 0.789306, 0.789094, 0.788883, 0.788673, 0.788463, 
                               0.788254, 0.788046, 0.787838, 0.787631, 0.787424, 0.787218, 0.787012, 
                               0.786807, 0.786602, 0.786399, 0.786195, 0.785992, 0.78579, 0.785588, 
                               0.785387, 0.785186, 0.784986, 0.784787, 0.784588, 0.784389, 0.784191, 
                               0.783994, 0.783797, 0.7836, 0.783405, 0.783209, 0.783014, 0.78282, 
                               0.782626, 0.782433, 0.78224, 0.782048, 0.781856, 0.781664, 0.781474, 
                               0.781283, 0.781093, 0.780904, 0.780715, 0.780527, 0.780339, 0.780151, 
                               0.779964, 0.779778, 0.779592, 0.779406, 0.779221, 0.779036, 0.778852, 
                               0.778668, 0.778485, 0.778302, 0.77812, 0.777938, 0.777756, 0.777575, 
                               0.777395, 0.777214, 0.777035, 0.776855, 0.776676, 0.776498, 0.77632, 
                               0.776143, 0.775965, 0.775789, 0.775612, 0.775436, 0.775261, 0.775086, 
                               0.774911, 0.774737)
      lines(x, TrappingProbability, type = "l", lty = MyLines[i + 1], lwd = 2, col = MyColors[i + 1])
    }
  }
  legend("bottomright", inset = 0.02, legend = my.expressions, lty = MyLines[2:length(MyLines)], lwd = 2, col = MyColors[2:length(MyColors)], cex = 0.8)
  dev.off()
}

PlotTrappingProbability1(cc = c(0.1, 1, 10, 100), PovertyLine = 1, B = 2, file = "/Users/josemiguelflorescontro/Desktop")

# The function below produces Figure 2 (b).

# Function No. 2

PlotTrappingProbability2 <- function(B = c(1, 2, 3, 4), PovertyLine = 1, file = "/Users/josemiguelflorescontro/Desktop"){
  # B indicates the capital barrier level. Note that, this is a vector that contains the values for which one wants to perform the analysis. Moreover, these values should match the ones in the Mathematica notebook: TrappingProbability.nb
  # PovertyLine indicates the value of the critical capital x* (or poverty line). This value should match the one in the Mathematica notebook: TrappingProbability.nb
  # file is the location where the .tex file that will be used to generate the plot is going to be saved.
  
  setwd(file)
  MyColors <- pal_jco()(length(B)) 
  MyLines <-seq(from = 1, to = length(B), by = 1) 
  TrappingProbability <- vector()
  my.expressions <- vector()
  # The values below were generated using Mathematica. In particular, they are outputs of the notebook: TrappingProbability.nb
  x <- c(1., 1.01, 1.02, 1.03, 1.04, 1.05, 1.06, 1.07, 1.08, 1.09, 1.1, 1.11, 
         1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18, 1.19, 1.2, 1.21, 1.22, 
         1.23, 1.24, 1.25, 1.26, 1.27, 1.28, 1.29, 1.3, 1.31, 1.32, 1.33, 
         1.34, 1.35, 1.36, 1.37, 1.38, 1.39, 1.4, 1.41, 1.42, 1.43, 1.44, 
         1.45, 1.46, 1.47, 1.48, 1.49, 1.5, 1.51, 1.52, 1.53, 1.54, 1.55, 
         1.56, 1.57, 1.58, 1.59, 1.6, 1.61, 1.62, 1.63, 1.64, 1.65, 1.66, 
         1.67, 1.68, 1.69, 1.7, 1.71, 1.72, 1.73, 1.74, 1.75, 1.76, 1.77, 
         1.78, 1.79, 1.8, 1.81, 1.82, 1.83, 1.84, 1.85, 1.86, 1.87, 1.88, 
         1.89, 1.9, 1.91, 1.92, 1.93, 1.94, 1.95, 1.96, 1.97, 1.98, 1.99, 2., 
         2.01, 2.02, 2.03, 2.04, 2.05, 2.06, 2.07, 2.08, 2.09, 2.1, 2.11, 
         2.12, 2.13, 2.14, 2.15, 2.16, 2.17, 2.18, 2.19, 2.2, 2.21, 2.22, 
         2.23, 2.24, 2.25, 2.26, 2.27, 2.28, 2.29, 2.3, 2.31, 2.32, 2.33, 
         2.34, 2.35, 2.36, 2.37, 2.38, 2.39, 2.4, 2.41, 2.42, 2.43, 2.44, 
         2.45, 2.46, 2.47, 2.48, 2.49, 2.5, 2.51, 2.52, 2.53, 2.54, 2.55, 
         2.56, 2.57, 2.58, 2.59, 2.6, 2.61, 2.62, 2.63, 2.64, 2.65, 2.66, 
         2.67, 2.68, 2.69, 2.7, 2.71, 2.72, 2.73, 2.74, 2.75, 2.76, 2.77, 
         2.78, 2.79, 2.8, 2.81, 2.82, 2.83, 2.84, 2.85, 2.86, 2.87, 2.88, 
         2.89, 2.9, 2.91, 2.92, 2.93, 2.94, 2.95, 2.96, 2.97, 2.98, 2.99, 3., 
         3.01, 3.02, 3.03, 3.04, 3.05, 3.06, 3.07, 3.08, 3.09, 3.1, 3.11, 
         3.12, 3.13, 3.14, 3.15, 3.16, 3.17, 3.18, 3.19, 3.2, 3.21, 3.22, 
         3.23, 3.24, 3.25, 3.26, 3.27, 3.28, 3.29, 3.3, 3.31, 3.32, 3.33, 
         3.34, 3.35, 3.36, 3.37, 3.38, 3.39, 3.4, 3.41, 3.42, 3.43, 3.44, 
         3.45, 3.46, 3.47, 3.48, 3.49, 3.5, 3.51, 3.52, 3.53, 3.54, 3.55, 
         3.56, 3.57, 3.58, 3.59, 3.6, 3.61, 3.62, 3.63, 3.64, 3.65, 3.66, 
         3.67, 3.68, 3.69, 3.7, 3.71, 3.72, 3.73, 3.74, 3.75, 3.76, 3.77, 
         3.78, 3.79, 3.8, 3.81, 3.82, 3.83, 3.84, 3.85, 3.86, 3.87, 3.88, 
         3.89, 3.9, 3.91, 3.92, 3.93, 3.94, 3.95, 3.96, 3.97, 3.98, 3.99, 4., 
         4.01, 4.02, 4.03, 4.04, 4.05, 4.06, 4.07, 4.08, 4.09, 4.1, 4.11, 
         4.12, 4.13, 4.14, 4.15, 4.16, 4.17, 4.18, 4.19, 4.2, 4.21, 4.22, 
         4.23, 4.24, 4.25, 4.26, 4.27, 4.28, 4.29, 4.3, 4.31, 4.32, 4.33, 
         4.34, 4.35, 4.36, 4.37, 4.38, 4.39, 4.4, 4.41, 4.42, 4.43, 4.44, 
         4.45, 4.46, 4.47, 4.48, 4.49, 4.5, 4.51, 4.52, 4.53, 4.54, 4.55, 
         4.56, 4.57, 4.58, 4.59, 4.6, 4.61, 4.62, 4.63, 4.64, 4.65, 4.66, 
         4.67, 4.68, 4.69, 4.7, 4.71, 4.72, 4.73, 4.74, 4.75, 4.76, 4.77, 
         4.78, 4.79, 4.8, 4.81, 4.82, 4.83, 4.84, 4.85, 4.86, 4.87, 4.88, 
         4.89, 4.9, 4.91, 4.92, 4.93, 4.94, 4.95, 4.96, 4.97, 4.98, 4.99, 5.)
  for (i in 1:length(B)){
    if (i==1){
      my.expressions <-c(my.expressions, paste0("Original Process", " ($B$ = ", B[i], ")"))
      TrappingProbability <- c(1., 0.994192, 0.990632, 0.987626, 0.984937, 0.982468, 0.980164, 
                               0.977992, 0.975928, 0.973956, 0.972065, 0.970243, 0.968484, 0.966782, 
                               0.965131, 0.963527, 0.961967, 0.960446, 0.958963, 0.957514, 0.956099, 
                               0.954714, 0.953358, 0.952029, 0.950726, 0.949449, 0.948194, 0.946963, 
                               0.945752, 0.944563, 0.943393, 0.942242, 0.941109, 0.939994, 0.938896, 
                               0.937814, 0.936748, 0.935697, 0.934661, 0.933639, 0.932631, 0.931636, 
                               0.930654, 0.929685, 0.928728, 0.927783, 0.926849, 0.925927, 0.925015, 
                               0.924115, 0.923224, 0.922344, 0.921474, 0.920613, 0.919762, 0.91892, 
                               0.918087, 0.917262, 0.916447, 0.915639, 0.91484, 0.914049, 0.913266, 
                               0.91249, 0.911722, 0.910962, 0.910208, 0.909462, 0.908722, 0.90799, 
                               0.907264, 0.906544, 0.905832, 0.905125, 0.904424, 0.90373, 0.903042, 
                               0.902359, 0.901683, 0.901012, 0.900346, 0.899686, 0.899031, 0.898382, 
                               0.897738, 0.897099, 0.896465, 0.895836, 0.895212, 0.894593, 0.893978, 
                               0.893368, 0.892763, 0.892162, 0.891566, 0.890974, 0.890386, 0.889803, 
                               0.889223, 0.888648, 0.888077, 0.88751, 0.886947, 0.886388, 0.885833, 
                               0.885281, 0.884734, 0.88419, 0.883649, 0.883112, 0.882579, 0.882049, 
                               0.881523, 0.881, 0.880481, 0.879964, 0.879451, 0.878942, 0.878435, 
                               0.877932, 0.877432, 0.876935, 0.876441, 0.875949, 0.875461, 0.874976, 
                               0.874494, 0.874015, 0.873538, 0.873064, 0.872593, 0.872125, 0.871659, 
                               0.871197, 0.870736, 0.870279, 0.869824, 0.869371, 0.868921, 0.868474, 
                               0.868029, 0.867586, 0.867146, 0.866709, 0.866273, 0.86584, 0.86541, 
                               0.864981, 0.864555, 0.864131, 0.86371, 0.86329, 0.862873, 0.862458, 
                               0.862045, 0.861634, 0.861226, 0.860819, 0.860414, 0.860012, 0.859611, 
                               0.859213, 0.858816, 0.858421, 0.858029, 0.857638, 0.857249, 0.856862, 
                               0.856477, 0.856093, 0.855712, 0.855332, 0.854954, 0.854578, 0.854204, 
                               0.853831, 0.853461, 0.853092, 0.852724, 0.852358, 0.851994, 0.851632, 
                               0.851271, 0.850912, 0.850554, 0.850198, 0.849844, 0.849491, 0.84914, 
                               0.84879, 0.848442, 0.848095, 0.84775, 0.847407, 0.847064, 0.846724, 
                               0.846384, 0.846047, 0.84571, 0.845375, 0.845042, 0.84471, 0.844379, 
                               0.844049, 0.843721, 0.843395, 0.843069, 0.842745, 0.842423, 0.842101, 
                               0.841781, 0.841462, 0.841145, 0.840829, 0.840514, 0.8402, 0.839887, 
                               0.839576, 0.839266, 0.838957, 0.83865, 0.838343, 0.838038, 0.837734, 
                               0.837431, 0.837129, 0.836829, 0.836529, 0.836231, 0.835934, 0.835637, 
                               0.835342, 0.835049, 0.834756, 0.834464, 0.834174, 0.833884, 0.833595, 
                               0.833308, 0.833022, 0.832736, 0.832452, 0.832169, 0.831886, 0.831605, 
                               0.831325, 0.831046, 0.830767, 0.83049, 0.830214, 0.829939, 0.829664, 
                               0.829391, 0.829118, 0.828847, 0.828576, 0.828307, 0.828038, 0.82777, 
                               0.827503, 0.827237, 0.826972, 0.826708, 0.826445, 0.826182, 0.825921, 
                               0.82566, 0.8254, 0.825141, 0.824883, 0.824626, 0.82437, 0.824114, 
                               0.82386, 0.823606, 0.823353, 0.823101, 0.822849, 0.822599, 0.822349, 
                               0.8221, 0.821852, 0.821604, 0.821358, 0.821112, 0.820867, 0.820622, 
                               0.820379, 0.820136, 0.819894, 0.819653, 0.819412, 0.819173, 0.818934, 
                               0.818695, 0.818458, 0.818221, 0.817985, 0.817749, 0.817515, 0.817281, 
                               0.817047, 0.816815, 0.816583, 0.816352, 0.816121, 0.815892, 0.815662, 
                               0.815434, 0.815206, 0.814979, 0.814753, 0.814527, 0.814302, 0.814077, 
                               0.813854, 0.81363, 0.813408, 0.813186, 0.812965, 0.812744, 0.812524, 
                               0.812305, 0.812086, 0.811868, 0.811651, 0.811434, 0.811217, 0.811002, 
                               0.810787, 0.810572, 0.810358, 0.810145, 0.809933, 0.80972, 0.809509, 
                               0.809298, 0.809088, 0.808878, 0.808669, 0.80846, 0.808252, 0.808045, 
                               0.807838, 0.807631, 0.807425, 0.80722, 0.807015, 0.806811, 0.806608, 
                               0.806404, 0.806202, 0.806, 0.805798, 0.805597, 0.805397, 0.805197, 
                               0.804998, 0.804799, 0.8046, 0.804403, 0.804205, 0.804009, 0.803812, 
                               0.803616, 0.803421, 0.803226, 0.803032, 0.802838, 0.802645, 0.802452, 
                               0.80226, 0.802068, 0.801876, 0.801685, 0.801495, 0.801305, 0.801116, 
                               0.800927, 0.800738, 0.80055, 0.800362, 0.800175, 0.799989, 0.799802, 
                               0.799617, 0.799431, 0.799246, 0.799062, 0.798878, 0.798694, 0.798511, 
                               0.798329, 0.798147, 0.797965, 0.797783, 0.797603, 0.797422, 0.797242, 
                               0.797062, 0.796883)
      # This is the name of the .tex file that will be saved in the location specified in the function.
      tikz('PlotTrappingProbability2.tex', standAlone = TRUE, width = 4, height = 4, packages = c("\\usepackage{tikz}", "\\usepackage[active,tightpage,psfixbb]{preview}", "\\PreviewEnvironment{pgfpicture}", "\\setlength\\PreviewBorder{0pt}", "\\usepackage{amssymb}", "\\usepackage{scalerel}"))
      par(mgp = c(2.5, 1, 0), mar = c(3.5, 3.5, 1, 1) + 0.1)
      plot(x, TrappingProbability, type = "l", lwd = 2, col = MyColors[1], xaxs = "i", yaxs = "i", xlab = "Initial Capital", ylab = "$\\psi^{\\scaleto{{\\fontfamily{qcr}\\selectfont P}}{2.5pt}}(x)$", ylim = c(0, 1), xlim = c(min(x), max(x)), cex.lab = 1, cex.axis = 1, xaxt = "n")
      abline(v = PovertyLine, lty = 2, lwd = 0.5, col = "red")
      axis(1,at = c(1, 2, 3, 4, 5), labels = FALSE)
      mtext(c("$x^{*} = 1$", "2", "3", "4", "5"), side = 1, line = 1, at = c(1, 2, 3, 4, 5), col = c("red", rep("black", 4)))
    }else if (i == 2){
      my.expressions <-c(my.expressions, paste0("$B$", " = ", B[i]))
      TrappingProbability <- c(0.96736, 0.966064, 0.964788, 0.963531, 0.962292, 0.96107, 0.959865, 
                               0.958675, 0.957502, 0.956343, 0.955199, 0.954069, 0.952953, 0.95185, 
                               0.95076, 0.949683, 0.948618, 0.947564, 0.946523, 0.945492, 0.944473, 
                               0.943464, 0.942466, 0.941477, 0.940499, 0.939531, 0.938572, 0.937622, 
                               0.936682, 0.93575, 0.934827, 0.933913, 0.933007, 0.932109, 0.931219, 
                               0.930337, 0.929463, 0.928596, 0.927737, 0.926885, 0.92604, 0.925202, 
                               0.924371, 0.923547, 0.922729, 0.921918, 0.921113, 0.920315, 0.919523, 
                               0.918737, 0.917957, 0.917182, 0.916414, 0.915651, 0.914894, 0.914143, 
                               0.913397, 0.912656, 0.91192, 0.91119, 0.910465, 0.909745, 0.909029, 
                               0.908319, 0.907614, 0.906913, 0.906217, 0.905526, 0.904839, 0.904156, 
                               0.903478, 0.902805, 0.902135, 0.90147, 0.90081, 0.900153, 0.8995, 
                               0.898852, 0.898207, 0.897566, 0.896929, 0.896296, 0.895667, 0.895042, 
                               0.89442, 0.893802, 0.893187, 0.892576, 0.891969, 0.891365, 0.890764, 
                               0.890167, 0.889573, 0.888982, 0.888395, 0.887811, 0.88723, 0.886652, 
                               0.886078, 0.885506, 0.884937, 0.884372, 0.883811, 0.883254, 0.882701, 
                               0.882151, 0.881606, 0.881063, 0.880525, 0.87999, 0.879459, 0.878931, 
                               0.878406, 0.877885, 0.877368, 0.876853, 0.876342, 0.875834, 0.875329, 
                               0.874828, 0.874329, 0.873834, 0.873342, 0.872852, 0.872366, 0.871883, 
                               0.871402, 0.870924, 0.870449, 0.869977, 0.869508, 0.869042, 0.868578, 
                               0.868116, 0.867658, 0.867202, 0.866748, 0.866298, 0.865849, 0.865403, 
                               0.86496, 0.864519, 0.86408, 0.863644, 0.863211, 0.862779, 0.86235, 
                               0.861923, 0.861499, 0.861076, 0.860656, 0.860238, 0.859822, 0.859409, 
                               0.858997, 0.858588, 0.858181, 0.857775, 0.857372, 0.856971, 0.856572, 
                               0.856175, 0.85578, 0.855386, 0.854995, 0.854606, 0.854218, 0.853832, 
                               0.853449, 0.853067, 0.852687, 0.852308, 0.851932, 0.851557, 0.851184, 
                               0.850813, 0.850443, 0.850075, 0.849709, 0.849345, 0.848982, 0.848621, 
                               0.848261, 0.847903, 0.847547, 0.847192, 0.846839, 0.846488, 0.846138, 
                               0.845789, 0.845442, 0.845097, 0.844753, 0.84441, 0.84407, 0.84373, 
                               0.843392, 0.843055, 0.84272, 0.842386, 0.842054, 0.841723, 0.841393, 
                               0.841065, 0.840738, 0.840413, 0.840089, 0.839766, 0.839444, 0.839124, 
                               0.838805, 0.838487, 0.838171, 0.837856, 0.837542, 0.837229, 0.836918, 
                               0.836608, 0.836299, 0.835991, 0.835684, 0.835379, 0.835075, 0.834772, 
                               0.83447, 0.834169, 0.83387, 0.833571, 0.833274, 0.832978, 0.832683, 
                               0.832389, 0.832096, 0.831804, 0.831514, 0.831224, 0.830936, 0.830648, 
                               0.830362, 0.830076, 0.829792, 0.829509, 0.829227, 0.828945, 0.828665, 
                               0.828386, 0.828107, 0.82783, 0.827554, 0.827279, 0.827004, 0.826731, 
                               0.826458, 0.826187, 0.825916, 0.825647, 0.825378, 0.82511, 0.824843, 
                               0.824577, 0.824312, 0.824048, 0.823785, 0.823523, 0.823261, 0.823001, 
                               0.822741, 0.822482, 0.822224, 0.821967, 0.821711, 0.821455, 0.821201, 
                               0.820947, 0.820694, 0.820442, 0.82019, 0.81994, 0.81969, 0.819441, 
                               0.819193, 0.818946, 0.818699, 0.818454, 0.818209, 0.817964, 0.817721, 
                               0.817478, 0.817236, 0.816995, 0.816755, 0.816515, 0.816276, 0.816038, 
                               0.815801, 0.815564, 0.815328, 0.815093, 0.814858, 0.814624, 0.814391, 
                               0.814159, 0.813927, 0.813696, 0.813466, 0.813236, 0.813007, 0.812779, 
                               0.812551, 0.812324, 0.812098, 0.811872, 0.811647, 0.811423, 0.811199, 
                               0.810976, 0.810754, 0.810532, 0.810311, 0.81009, 0.809871, 0.809651, 
                               0.809433, 0.809215, 0.808998, 0.808781, 0.808565, 0.808349, 0.808134, 
                               0.80792, 0.807706, 0.807493, 0.807281, 0.807069, 0.806858, 0.806647, 
                               0.806437, 0.806227, 0.806018, 0.80581, 0.805602, 0.805394, 0.805188, 
                               0.804981, 0.804776, 0.804571, 0.804366, 0.804162, 0.803959, 0.803756, 
                               0.803553, 0.803352, 0.80315, 0.802949, 0.802749, 0.802549, 0.80235, 
                               0.802152, 0.801953, 0.801756, 0.801559, 0.801362, 0.801166, 0.80097, 
                               0.800775, 0.80058, 0.800386, 0.800193, 0.8, 0.799807, 0.799615, 
                               0.799423, 0.799232, 0.799041, 0.798851, 0.798661, 0.798472, 0.798283, 
                               0.798095, 0.797907, 0.79772, 0.797533, 0.797346, 0.79716, 0.796975, 
                               0.796789, 0.796605, 0.796421, 0.796237, 0.796053, 0.795871, 0.795688, 
                               0.795506, 0.795325, 0.795143, 0.794963, 0.794783, 0.794603, 0.794423, 
                               0.794244, 0.794066)
      lines(x, TrappingProbability, type = "l", lty = MyLines[i], lwd = 2, col = MyColors[i])
    } else if (i == 3){
      my.expressions <-c(my.expressions, paste0("$B$", " = ", B[i]))
      TrappingProbability <- c(0.947489, 0.946445, 0.945413, 0.944393, 0.943384, 0.942387, 0.9414, 
                               0.940424, 0.939459, 0.938503, 0.937558, 0.936622, 0.935696, 0.934779, 
                               0.933871, 0.932973, 0.932082, 0.931201, 0.930328, 0.929463, 0.928606, 
                               0.927757, 0.926915, 0.926082, 0.925255, 0.924436, 0.923624, 0.92282, 
                               0.922022, 0.921231, 0.920446, 0.919668, 0.918897, 0.918131, 0.917372, 
                               0.916619, 0.915873, 0.915132, 0.914396, 0.913667, 0.912943, 0.912225, 
                               0.911512, 0.910804, 0.910102, 0.909405, 0.908713, 0.908026, 0.907344, 
                               0.906667, 0.905994, 0.905327, 0.904664, 0.904005, 0.903352, 0.902702, 
                               0.902057, 0.901417, 0.90078, 0.900148, 0.89952, 0.898897, 0.898277, 
                               0.897661, 0.897049, 0.896441, 0.895837, 0.895237, 0.89464, 0.894048, 
                               0.893458, 0.892873, 0.892291, 0.891712, 0.891137, 0.890566, 0.889997, 
                               0.889432, 0.888871, 0.888312, 0.887757, 0.887205, 0.886657, 0.886111, 
                               0.885568, 0.885029, 0.884492, 0.883959, 0.883428, 0.8829, 0.882375, 
                               0.881853, 0.881334, 0.880818, 0.880304, 0.879793, 0.879284, 0.878779, 
                               0.878276, 0.877775, 0.877277, 0.876782, 0.876289, 0.875799, 0.875311, 
                               0.874826, 0.874343, 0.873862, 0.873384, 0.872908, 0.872434, 0.871963, 
                               0.871494, 0.871027, 0.870563, 0.8701, 0.86964, 0.869182, 0.868726, 
                               0.868273, 0.867821, 0.867372, 0.866924, 0.866479, 0.866035, 0.865594, 
                               0.865155, 0.864717, 0.864282, 0.863848, 0.863416, 0.862987, 0.862559, 
                               0.862133, 0.861709, 0.861286, 0.860866, 0.860447, 0.86003, 0.859615, 
                               0.859202, 0.85879, 0.85838, 0.857972, 0.857565, 0.857161, 0.856757, 
                               0.856356, 0.855956, 0.855558, 0.855161, 0.854766, 0.854372, 0.85398, 
                               0.85359, 0.853201, 0.852814, 0.852428, 0.852044, 0.851661, 0.85128, 
                               0.8509, 0.850522, 0.850145, 0.849769, 0.849395, 0.849023, 0.848651, 
                               0.848282, 0.847913, 0.847546, 0.84718, 0.846816, 0.846453, 0.846091, 
                               0.845731, 0.845372, 0.845014, 0.844658, 0.844302, 0.843948, 0.843596, 
                               0.843244, 0.842894, 0.842545, 0.842198, 0.841851, 0.841506, 0.841162, 
                               0.840819, 0.840477, 0.840137, 0.839797, 0.839459, 0.839122, 0.838786, 
                               0.838452, 0.838118, 0.837785, 0.837454, 0.837124, 0.836795, 0.836467, 
                               0.836141, 0.835816, 0.835492, 0.83517, 0.834849, 0.834529, 0.834211, 
                               0.833894, 0.833578, 0.833263, 0.83295, 0.832638, 0.832327, 0.832018, 
                               0.831709, 0.831402, 0.831096, 0.830791, 0.830488, 0.830186, 0.829884, 
                               0.829584, 0.829285, 0.828987, 0.828691, 0.828395, 0.828101, 0.827808, 
                               0.827515, 0.827224, 0.826934, 0.826645, 0.826357, 0.826071, 0.825785, 
                               0.8255, 0.825216, 0.824934, 0.824652, 0.824371, 0.824092, 0.823813, 
                               0.823536, 0.823259, 0.822983, 0.822709, 0.822435, 0.822162, 0.82189, 
                               0.821619, 0.82135, 0.821081, 0.820813, 0.820545, 0.820279, 0.820014, 
                               0.81975, 0.819486, 0.819224, 0.818962, 0.818701, 0.818441, 0.818182, 
                               0.817924, 0.817666, 0.81741, 0.817154, 0.8169, 0.816646, 0.816392, 
                               0.81614, 0.815889, 0.815638, 0.815388, 0.815139, 0.814891, 0.814643, 
                               0.814397, 0.814151, 0.813906, 0.813661, 0.813418, 0.813175, 0.812933, 
                               0.812692, 0.812451, 0.812212, 0.811973, 0.811734, 0.811497, 0.81126, 
                               0.811024, 0.810789, 0.810554, 0.81032, 0.810087, 0.809855, 0.809623, 
                               0.809392, 0.809161, 0.808932, 0.808703, 0.808474, 0.808247, 0.80802, 
                               0.807793, 0.807568, 0.807343, 0.807119, 0.806895, 0.806672, 0.80645, 
                               0.806228, 0.806007, 0.805786, 0.805567, 0.805347, 0.805129, 0.804911, 
                               0.804694, 0.804477, 0.804261, 0.804045, 0.803831, 0.803616, 0.803403, 
                               0.80319, 0.802977, 0.802765, 0.802554, 0.802344, 0.802133, 0.801924, 
                               0.801715, 0.801507, 0.801299, 0.801092, 0.800885, 0.800679, 0.800473, 
                               0.800268, 0.800064, 0.79986, 0.799657, 0.799454, 0.799251, 0.79905, 
                               0.798849, 0.798648, 0.798448, 0.798248, 0.798049, 0.79785, 0.797652, 
                               0.797455, 0.797258, 0.797061, 0.796865, 0.79667, 0.796475, 0.796281, 
                               0.796087, 0.795893, 0.7957, 0.795508, 0.795316, 0.795124, 0.794933, 
                               0.794743, 0.794552, 0.794363, 0.794174, 0.793985, 0.793797, 0.793609, 
                               0.793422, 0.793235, 0.793049, 0.792863, 0.792678, 0.792493, 0.792308, 
                               0.792124, 0.791941, 0.791757, 0.791575, 0.791393, 0.791211, 0.791029, 
                               0.790848, 0.790668, 0.790488, 0.790308, 0.790129, 0.78995, 0.789772, 
                               0.789594, 0.789416)
      lines(x, TrappingProbability, type = "l", lty = MyLines[i], lwd = 2, col = MyColors[i])
    } else{
      my.expressions <-c(my.expressions, paste0("$B$", " = ", B[i]))
      TrappingProbability <- c(0.930872, 0.929955, 0.929047, 0.928149, 0.92726, 0.92638, 0.925509, 
                               0.924646, 0.923791, 0.922945, 0.922107, 0.921277, 0.920454, 0.919639, 
                               0.918832, 0.918032, 0.917239, 0.916453, 0.915674, 0.914901, 0.914136, 
                               0.913377, 0.912624, 0.911878, 0.911138, 0.910404, 0.909676, 0.908953, 
                               0.908237, 0.907527, 0.906822, 0.906122, 0.905428, 0.90474, 0.904056, 
                               0.903378, 0.902705, 0.902037, 0.901374, 0.900716, 0.900062, 0.899413, 
                               0.898769, 0.89813, 0.897495, 0.896865, 0.896239, 0.895617, 0.894999, 
                               0.894386, 0.893777, 0.893172, 0.892571, 0.891974, 0.891381, 0.890792, 
                               0.890206, 0.889625, 0.889047, 0.888473, 0.887902, 0.887335, 0.886772, 
                               0.886212, 0.885655, 0.885102, 0.884553, 0.884006, 0.883463, 0.882923, 
                               0.882386, 0.881853, 0.881323, 0.880795, 0.880271, 0.87975, 0.879231, 
                               0.878716, 0.878204, 0.877694, 0.877187, 0.876683, 0.876182, 0.875684, 
                               0.875188, 0.874695, 0.874205, 0.873717, 0.873232, 0.87275, 0.87227, 
                               0.871792, 0.871317, 0.870845, 0.870375, 0.869907, 0.869442, 0.868979, 
                               0.868518, 0.86806, 0.867604, 0.86715, 0.866699, 0.866249, 0.865802, 
                               0.865357, 0.864915, 0.864474, 0.864036, 0.863599, 0.863165, 0.862733, 
                               0.862302, 0.861874, 0.861448, 0.861024, 0.860601, 0.860181, 0.859762, 
                               0.859346, 0.858931, 0.858518, 0.858107, 0.857698, 0.857291, 0.856885, 
                               0.856482, 0.85608, 0.855679, 0.855281, 0.854884, 0.854489, 0.854096, 
                               0.853704, 0.853314, 0.852926, 0.852539, 0.852154, 0.85177, 0.851388, 
                               0.851008, 0.850629, 0.850252, 0.849876, 0.849502, 0.849129, 0.848758, 
                               0.848388, 0.84802, 0.847653, 0.847288, 0.846924, 0.846562, 0.846201, 
                               0.845841, 0.845483, 0.845126, 0.844771, 0.844417, 0.844064, 0.843712, 
                               0.843362, 0.843014, 0.842666, 0.84232, 0.841975, 0.841631, 0.841289, 
                               0.840948, 0.840608, 0.84027, 0.839932, 0.839596, 0.839261, 0.838928, 
                               0.838595, 0.838264, 0.837934, 0.837605, 0.837277, 0.836951, 0.836625, 
                               0.836301, 0.835978, 0.835655, 0.835334, 0.835015, 0.834696, 0.834378, 
                               0.834062, 0.833746, 0.833432, 0.833118, 0.832806, 0.832495, 0.832184, 
                               0.831875, 0.831567, 0.83126, 0.830953, 0.830648, 0.830344, 0.830041, 
                               0.829739, 0.829438, 0.829137, 0.828838, 0.82854, 0.828242, 0.827946, 
                               0.82765, 0.827356, 0.827062, 0.82677, 0.826478, 0.826187, 0.825897, 
                               0.825608, 0.82532, 0.825032, 0.824746, 0.82446, 0.824176, 0.823892, 
                               0.823609, 0.823327, 0.823046, 0.822765, 0.822486, 0.822207, 0.821929, 
                               0.821652, 0.821376, 0.8211, 0.820826, 0.820552, 0.820279, 0.820007, 
                               0.819735, 0.819465, 0.819195, 0.818926, 0.818657, 0.81839, 0.818123, 
                               0.817857, 0.817592, 0.817327, 0.817063, 0.8168, 0.816538, 0.816276, 
                               0.816016, 0.815755, 0.815496, 0.815237, 0.814979, 0.814722, 0.814466, 
                               0.81421, 0.813954, 0.8137, 0.813446, 0.813193, 0.812941, 0.812689, 
                               0.812438, 0.812187, 0.811938, 0.811689, 0.81144, 0.811193, 0.810945, 
                               0.810699, 0.810453, 0.810208, 0.809963, 0.80972, 0.809476, 0.809234, 
                               0.808992, 0.80875, 0.808509, 0.808269, 0.80803, 0.807791, 0.807552, 
                               0.807315, 0.807078, 0.806841, 0.806605, 0.80637, 0.806135, 0.805901, 
                               0.805667, 0.805434, 0.805202, 0.80497, 0.804738, 0.804508, 0.804278, 
                               0.804048, 0.803819, 0.803591, 0.803363, 0.803137, 0.802911, 0.802685, 
                               0.80246, 0.802236, 0.802013, 0.80179, 0.801568, 0.801346, 0.801125, 
                               0.800905, 0.800685, 0.800466, 0.800248, 0.80003, 0.799813, 0.799597, 
                               0.799381, 0.799166, 0.798951, 0.798737, 0.798524, 0.798311, 0.798099, 
                               0.797887, 0.797676, 0.797465, 0.797256, 0.797046, 0.796838, 0.796629, 
                               0.796422, 0.796215, 0.796008, 0.795803, 0.795597, 0.795393, 0.795188, 
                               0.794985, 0.794782, 0.794579, 0.794377, 0.794176, 0.793975, 0.793774, 
                               0.793574, 0.793375, 0.793176, 0.792978, 0.79278, 0.792583, 0.792386, 
                               0.79219, 0.791994, 0.791799, 0.791604, 0.79141, 0.791217, 0.791023, 
                               0.790831, 0.790638, 0.790447, 0.790256, 0.790065, 0.789875, 0.789685, 
                               0.789495, 0.789307, 0.789118, 0.78893, 0.788743, 0.788556, 0.78837, 
                               0.788184, 0.787998, 0.787813, 0.787628, 0.787444, 0.787261, 0.787077, 
                               0.786894, 0.786712, 0.78653, 0.786349, 0.786168, 0.785987, 0.785807, 
                               0.785627, 0.785448, 0.785269, 0.78509, 0.784912, 0.784735, 0.784558, 
                               0.784381, 0.784205)
      lines(x, TrappingProbability, type = "l", lty = MyLines[i], lwd = 2, col = MyColors[i])
    }
  }
  legend("bottomright", inset = 0.02, legend = my.expressions, lty = MyLines, lwd = 2, col = MyColors, cex = 0.8)
  dev.off()
}

PlotTrappingProbability2(B = c(1, 2, 3, 4), PovertyLine = 1, file = "/Users/josemiguelflorescontro/Desktop")






